using System.Net;
using System.Net.Mail;
using System.Threading.Tasks;

namespace Matcha.Server.MailClient
{
    public static class MailClient
    {
        public static async Task SendMailAsync(string to, string subject, string body)
        {
            using var mail = new MailMessage()
            {
                From = new MailAddress("mishayagudin2012@gmail.ru"),
                Subject = subject,
                Body = body
            };
            mail.To.Add(new MailAddress(to));

            using var client = new SmtpClient()
            {
                Host = "smtp.gmail.com",
                Port = 587,
                UseDefaultCredentials = false,
                Credentials = new NetworkCredential(AppConfig.Constants.GmailLogin, AppConfig.Constants.GmailPassword),
                EnableSsl = true,
                DeliveryMethod = SmtpDeliveryMethod.Network
            };

            mail.IsBodyHtml = true;
            mail.Body = "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.0 Transitional//RU'> <tr><th>     <table bgcolor='#5D535E' border='0' cellpadding='0' cellspacing='0' width='100%'>         <tbody>         <tr>             <th align='left' style='width:590'>         <table border='0' cellpadding='0' cellspacing='0' width='100%'>             <tbody><tr><th>             <table align='left' border='0' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td style='padding-bottom:0px;padding-left:80px;padding-top:0px'>                 <span style='color: #EC96A4; font-size:30px;font-family: Verdana, Geneva, sans-serif;' charset='utf-8' lang='ru'>Matcha — найди свою судьбу</span>             </td></tr></tbody></table>         </th></tr></tbody>         </table>     </th>             <th align='right' style='width:80px'>         <table align='right' border='0' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><th style='padding:0;width:80px'>             <div style='background:#548fad;width:80px'>                 <img height='80' width='80' style='clear:both;display:block;max-width:100%;text-decoration:none;width:auto' src='https://resize.yandex.net/mailservice?url=https%3A%2F%2Fimg03.en25.com%2FEloquaImages%2Fclients%2FIntelCorporation%2F%257Bad5fc862-8b23-4f12-bf31-542719cd5d3c%257D_548FAD-Spark-25x25.jpg&amp;proxy=yes&amp;key=25032d49afb21a3b02f4a774275ced4b'>             </div>         </th></tr></tbody></table>             </th>         </tr>     </tbody>     </table>     <table border='0' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><th style='background:#5D535E;padding:0;width:80px'>         &nbsp;     </th><th style='background:#41728a;padding:0;width:590px'>         <table border='0' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><th>             <table align='right' border='0' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><th style='padding:0 80px 0 490px;width:20px'>                 <div style='background:#b9d6e5;width:20px'>                     <img height='20' width='20' style='clear:both;display:block;height:20px;max-width:100%;text-decoration:none;width:20px' src='https://resize.yandex.net/mailservice?url=https%3A%2F%2Fimg03.en25.com%2FEloquaImages%2Fclients%2FIntelCorporation%2F%257Bbb3fc26a-c12c-4a2b-b0d2-c1aa60c2a4c5%257D_B9D6E5-Spark-25x25.jpg&amp;proxy=yes&amp;key=198c225cbd19331e24c0bcfb13e08649'>                 </div>             </th></tr></tbody></table>         </th></tr><tr><th  style='border:medium;padding:32px 75px 32px 75px;vertical-align:middle;width:100%'><p style='color:#ffffff;font-family:'arial' , 'helvetica' , sans-serif;font-size:20px;font-weight:400;line-height:28px;margin:0 0 16px 0;padding:0;text-align:left'>Deploy and Scale Compute-Intense Workloads across Diverse Architectures</p>             <h1 style='color:#ffffff;font-family:'arial' , 'helvetica' , sans-serif;font-size:36px;font-weight:400;line-height:42px;margin:0 0 16px 0;padding:0;text-align:left'>Intel<sup style='line-height:1px'>®</sup> oneAPI Toolkits 2021.2 Update Available</h1>             <table align='left' border='0' cellpadding='0' cellspacing='0'><tbody><tr><td style='background:#ffffff;padding:10px 24px 10px 24px'>                 <a href='http://app.plan.intel.com/e/er?cid=em&amp;source=elo&amp;campid=iags_WW_iagsoapi2_EMPU_EN_2021_oneAPI%202021.2%20Release_C-MKA-22972_T-MKA-24176&amp;content=iags_WW_iagsoapi2_EMPU_EN_2021_oneAPI%202021.2%20Release_C-MKA-22972_T-MKA-24176&amp;elq_cid=5997635&amp;em_id=68726&amp;elqrid=5941524c49c64ea9b6cbfd2c1098e7f5&amp;elqcampid=43921&amp;erpm_id=9069920&amp;s=334284386&amp;lid=466938&amp;elqTrackId=53e038635ce840c49ff6ebfde2a3fab3&amp;elq=5941524c49c64ea9b6cbfd2c1098e7f5&amp;elqaid=68726&amp;elqat=1' target='_blank' style='color:#006abb;display:block;font-family:'arial' , 'helvetica' , sans-serif;font-size:16px;font-weight:400;line-height:20px;margin:0;text-align:center;text-decoration:none' data-vdir-href='https://mail.yandex.ru/re.jsx?uid=542911509&amp;c=LIZA&amp;cv=25.5.2&amp;mid=175640385467458252&amp;h=a,etdJu2Zmt3rO4lIPZfhPwQ&amp;l=aHR0cDovL2FwcC5wbGFuLmludGVsLmNvbS9lL2VyP2NpZD1lbSZzb3VyY2U9ZWxvJmNhbXBpZD1pYWdzX1dXX2lhZ3NvYXBpMl9FTVBVX0VOXzIwMjFfb25lQVBJJTIwMjAyMS4yJTIwUmVsZWFzZV9DLU1LQS0yMjk3Ml9ULU1LQS0yNDE3NiZjb250ZW50PWlhZ3NfV1dfaWFnc29hcGkyX0VNUFVfRU5fMjAyMV9vbmVBUEklMjAyMDIxLjIlMjBSZWxlYXNlX0MtTUtBLTIyOTcyX1QtTUtBLTI0MTc2JmVscV9jaWQ9NTk5NzYzNSZlbV9pZD02ODcyNiZlbHFyaWQ9NTk0MTUyNGM0OWM2NGVhOWI2Y2JmZDJjMTA5OGU3ZjUmZWxxY2FtcGlkPTQzOTIxJmVycG1faWQ9OTA2OTkyMCZzPTMzNDI4NDM4NiZsaWQ9NDY2OTM4JmVscVRyYWNrSWQ9NTNlMDM4NjM1Y2U4NDBjNDlmZjZlYmZkZTJhM2ZhYjMmZWxxPTU5NDE1MjRjNDljNjRlYTliNmNiZmQyYzEwOThlN2Y1JmVscWFpZD02ODcyNiZlbHFhdD0x' data-orig-href='http://app.plan.intel.com/e/er?cid=em&amp;source=elo&amp;campid=iags_WW_iagsoapi2_EMPU_EN_2021_oneAPI%202021.2%20Release_C-MKA-22972_T-MKA-24176&amp;content=iags_WW_iagsoapi2_EMPU_EN_2021_oneAPI%202021.2%20Release_C-MKA-22972_T-MKA-24176&amp;elq_cid=5997635&amp;em_id=68726&amp;elqrid=5941524c49c64ea9b6cbfd2c1098e7f5&amp;elqcampid=43921&amp;erpm_id=9069920&amp;s=334284386&amp;lid=466938&amp;elqTrackId=53e038635ce840c49ff6ebfde2a3fab3&amp;elq=5941524c49c64ea9b6cbfd2c1098e7f5&amp;elqaid=68726&amp;elqat=1' rel='noopener noreferrer'>Discover the Toolkits<img valign='middle' src='https://resize.yandex.net/mailservice?url=https%3A%2F%2Fimg03.en25.com%2FEloquaImages%2Fclients%2FIntelCorporation%2F%257Bc054784c-25ad-4375-800a-72225d53db68%257D_arrow_email_blue.png&amp;proxy=yes&amp;key=08eb07176d7e317e5887a8b70d4ea589'></a>             </td></tr></tbody></table>         </th></tr><tr><th style='width:100%'>             <table align='left' border='0' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><th  style='padding:0 562px 0 0;width:28px'>                 <div style='background:#b9d6e5;width:28px'>                     <img height='28' width='28' style='clear:both;display:block;height:28px;max-width:100%;text-decoration:none;width:28px' src='https://resize.yandex.net/mailservice?url=https%3A%2F%2Fimg03.en25.com%2FEloquaImages%2Fclients%2FIntelCorporation%2F%257Bbb3fc26a-c12c-4a2b-b0d2-c1aa60c2a4c5%257D_B9D6E5-Spark-25x25.jpg&amp;proxy=yes&amp;key=198c225cbd19331e24c0bcfb13e08649'>                 </div>             </th></tr></tbody></table>         </th></tr></tbody></table>     </th></tr></tbody></table>     <table align='left' bgcolor='#5D535E' border='0' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><th style='padding:0 590px 0 0;width:80px'>         <div style='background:#41728a;width:80px'>             <img height='80' width='80' style='clear:both;display:block;max-width:100%;text-decoration:none;width:auto' src='https://resize.yandex.net/mailservice?url=https%3A%2F%2Fimg03.en25.com%2FEloquaImages%2Fclients%2FIntelCorporation%2F%257Bb9ff8071-3f0f-477a-88a9-dc7562c4989f%257D_41728A-Spark-25x25.jpg&amp;proxy=yes&amp;key=bc586dd4b3e753a245cbb1281633c7ea'>         </div>     </th></tr></tbody></table> </th></tr>";

            await client.SendMailAsync(mail);
        }
    }
}
