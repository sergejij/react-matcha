CREATE PROCEDURE Login (
    email VARCHAR(128),
    password VARCHAR(128),

    OUT user_id BIGINT,
    OUT session_id BIGINT,

    OUT error_message VARCHAR(256)
)

BEGIN

    IF EXISTS(SELECT * FROM user_data WHERE user_data.email = email)
    THEN
        call LoginByEmail(email, password, user_id, session_id, error_message);
    ELSEIF EXISTS(SELECT * FROM user_data WHERE user_data.login = email)
    THEN
        call LoginByLogin(email, password, user_id, session_id, error_message);
    ELSEIF EXISTS(SELECT * FROM emails_for_confirm WHERE emails_for_confirm.email = email)
    THEN
        SET error_message = 'Email не подтвержден';
    ELSE
        SET error_message = 'Пользователь с таким email/login не найден';
    END IF;

END
